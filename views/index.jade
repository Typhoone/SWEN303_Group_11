extends layout

block content
	include toolbar.html
	link(href="/stylesheets/help.css", rel="stylesheet")
	link(href="/stylesheets/browse.css", rel="stylesheet")

	h1 Check out our 3 most recent additions!
	.col-xs-12
		ul.list-inline
			each val in result
				li
					a(href="/item?name="+val.itemname+"&imagename="+val.imagename+"&description="+val.description+"&stock="+val.stock+"&id="+val.id id=val.id)
						- var image = val.imagename;
						- var name = val.itemname;
						- var description = val.description;
						- var stock = val.stock;
						img(src='images/' + image + '.jpg', alt="failed", class="img-thumbnail")
						h4 #{name}
		.col-xs-3

	script.
		getCookie = function(cname) {
			var name = cname + "=";
			var ca = document.cookie.split(';');
			for(var i = 0; i <ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0)==' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length,c.length);
				}
			}
			return "";
		}

		var currentUser = getCookie("username");
		if(currentUser != ""){
			//If there is already a user then the user has navigated to the sign in page manually and hasn't signed out of the previous user. In any case do nohting until the sign out button is pressed.
		}else{
			var e = (!{JSON.stringify(email)});
			var id = (!{JSON.stringify(ID)});
			var name = (!{JSON.stringify(fname)});
			//If email hasn't been passed a syntax error is thrown. This is ironically good for us as it won't run the 	code below.
			document.cookie = "username=" + name;
			document.cookie = "email=" + e;
			document.cookie = "ID=" + id;
		}